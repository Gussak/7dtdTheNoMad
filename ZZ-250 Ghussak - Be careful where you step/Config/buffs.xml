<?xml version="1.0"?>
<GhussakTweaks>
  <append xpath="/buffs">
    <buff name="buffGSKStumbleOnThingsOnTheGround" hidden="false" help="visible mainly to check on buffs list if all blocks are working">
      <stack_type value="ignore"/>
      <duration value="6" help="player takes 3s to get up so 6s is like a cooldown safety to let player move away"/>
      <update_rate value="1"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".iGSKStumbleOTOTGtmp" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".iGSKStumbleOTOTGtmp" operation="set" value="1">
          <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="0"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LT" value="10"/>
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="0" help="ugh"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".iGSKStumbleOTOTGtmp" operation="set" value="1">
          <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="0"/>
          <requirement name="EntityHasMovementTag" tags="running"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LT" value="25"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar=".iGSKStumbleOTOTGtmp" operation="Equals" value="1"/>
        <triggered_effect trigger="onSelfBuffStart" action="CallGameEvent" event="eventGSKPlayerRagdoll"/>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message="[TNM] You stumble in something on the ground (crouch to prevent this)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Health" operation="add" value="-1"/>
      </effect_group>
    </buff>
  </append>
</GhussakTweaks>
