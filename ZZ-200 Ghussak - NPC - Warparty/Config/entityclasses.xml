<?xml version="1.0"?>
<GhussakTweaks>
  <append xpath="/entity_classes/entity_class[starts-with(@name, 'npc')]/property[@name='Tags' and not(contains(@value,'bandit'))]/@value" help="patch hirable NPCs to be easier to detect them TODO: could the hirecost property be read instead to add this tag?">,hireable,hirable</append>
  <append xpath="/entity_classes/entity_class[@name='playerMale']">
    <effect_group>
      <requirement name="CVarCompare" cvar="iGSKPlayerNPCFollowingCountCurrent" operation="GTE" value="1"/>
      <requirement name="CVarCompare" cvar=".iGSKSneakWithPlayerAllowed" operation="Equals" value="1"/>
      <triggered_effect trigger="onSelfCrouch" action="AddBuff" buff="buffGSKNPCsStartSneak3"/>
      <triggered_effect trigger="onSelfStand" action="AddBuff" buff="buffGSKNPCsStopSneak3"/>
    </effect_group>
  </append>
  <csv xpath="/entity_classes/entity_class[@name='playerMale']/effect_group/triggered_effect[(@trigger='onSelfEnteredGame' or @trigger='onSelfRespawn') and @action='AddBuff' and @target='self']/@buff" help="these buffs for entergame/respawn cannot add other buffs (only onStart but can onUpdate right?)" delim="," op="add">buffPlayerEnhancesNearbyFriendlyNPCs2</csv>
  <csv xpath="/entity_classes/entity_class[@name='playerMale']/effect_group/triggered_effect[(@trigger='onSelfEnteredGame' or @trigger='onSelfRespawn') and @action='AddBuff' and @target='self']/@buff" help="these buffs for entergame/respawn cannot add other buffs (only onStart but can onUpdate right?)" delim="," op="add">buffLeaderLimitsHiredNPCsAmount106</csv>
  <append xpath="/entity_classes/entity_class[starts-with(@name, 'npc')]" help="if you cant find them for any reason and to prevent that being a boring task as we should be able to just ask loudly where they are ;)">
    <property name="NavObject" value="navNPCfriendly"/>
    <effect_group>
      <triggered_effect trigger="onOtherAttackedSelf" action="AddBuff" buff="buffNPCtookDamageFightBack"/>
      <triggered_effect trigger="onOtherAttackedSelf" action="ModifyCVar" cvar="fGSKNPCSelfPreventDismissSecs" operation="set" value="300" help="they should not leave while they are in need, the engine may take a long time to process each NPC ?">
        <requirement name="CVarCompare" cvar="fGSKNPCSelfPreventDismissSecs" operation="LT" value="300"/>
      </triggered_effect>
    </effect_group>
  </append>
  <append xpath="/entity_classes/entity_class[@name='EntityLootContainerNPC']" help="non hired and raiders">
    <property name="NavObject" value="navNPCbackPack"/>
  </append>
  <set xpath="/entity_classes/entity_class[@name='BackpackNPC']/property[@name='NavObject']/@value" help="FAIL. was 'backpack', just append property failed ISSUE: still not working, may be because the LootListOnDeath is playerBackpack and so it will not show the nav obj to other player than it's owner, and hired NPCs seem to be considered like another player, like in: 'NPCs are the owner of their backpack'">navNPCbackPackHired</set>
  <append xpath="/entity_classes/entity_class[@name='BackpackNPC']" help="FAIL. try track it workaround">
    <effect_group>
      <triggered_effect trigger="onSelfFirstSpawn" action="AddBuff" target="self" buff="buffGSKAirDropHighlight"/>
    </effect_group>
    <property name="Tags" value="perkAT01,perkAT02,perkAT03" help="could be something else?"/>
    <property name="TrackerIcon" value="ui_game_symbol_assemble" help="FAIL. let it be detected like in: 'where is my stuff!!!' :)"/>
    <property name="SizeScale" value="7.0" help="ISSUE:WORKAROUND:TEMPORARY:REMOVELATER: this is an extremely dirty workaround to make it easier to find it as everything else fails..."/>
  </append>
  <append xpath="/entity_classes/entity_class[@name='npcAnimalFox']/property[@name='Tags']/@value" help="to let pettable animals be considered in the followers limiter">,melee</append>
</GhussakTweaks>
