<?xml version="1.0"?>
<GhussakTweaks>
  <append xpath="/buffs/buff[@name='buffElementFreezing' or @name='buffElementCold']/effect_group">
    <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardousWElementColdHook40">
      <requirement name="!HasBuff" buff="buffGSKHazardousWElementColdHook40"/>
    </triggered_effect>
  </append>
  <append xpath="/buffs/buff[@name='buffElementSweltering' or @name='buffElementHot' ]/effect_group">
    <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardousWElementHotHook40">
      <requirement name="!HasBuff" buff="buffGSKHazardousWElementHotHook40"/>
    </triggered_effect>
  </append>
  <append xpath="/buffs" help="TODOB: add at buffGSKPermanentGenericCheck21 the code that makes these buffs work">
    <buff name="buffGSKHazardousWBloodLoss53" icon_blink="true" icon="7dtdGskBloodLoss" description_key="buffGSKHazardousWBloodLossDesc">
      <damage_type value="BloodLoss"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathBloodLossLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardousWBloodLoss53"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardousWBloodLoss53"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="LTE" value="0.14"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathBloodLossLvl" operation="set" value="0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0.14"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathBloodLossLvl" operation="set" value="1"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0.21"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathBloodLossLvl" operation="set" value="2"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0.28"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathBloodLossLvl" operation="set" value="3"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0.35"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathBloodLossLvl" operation="set" value="4"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GTE" value="0.40"/>
        <!-- HELPGOOD: 40% is lethal -->
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathBloodLossLvl" operation="set" value="5"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="set" value="0">
          <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="LT" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardousWBloodLoss53">
          <requirement name="CVarCompare" cvar="iGSKNearDeathBloodLossLvl" operation="Equals" value="0"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKInPineForestBiomeMonstersThrive15" hidden="true">
      <stack_type value="replace"/>
      <duration value="0"/>
      <update_rate value="7.5"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Health" operation="add" value="2.5" target="selfAOE" range="60" target_tags="zombie">
          <requirement name="InBiome" biome="3" help="pineforest (all monsters thrive easier)"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardWDryAirIndicator" hidden="false" remove_on_death="true" description_key="dkbuffGSKHazardWDryAirIndicator" icon="ui_game_symbol_thirst" icon_blink="true" icon_color="255,255,0">
      <damage_type value="Dehydration"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <display_value value="iGSKNearDeathDryHotLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <update_rate value="1"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardWDryAirIndicator">
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="LT" value="1"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardWDryness40" icon="7dtdGskHazardDesert2" description_key="buffGSKHazardWDrynessDesc" name_key="DryAirHazard">
      <damage_type value="Dehydration"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathDryHotLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardWDryness40"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardWDryness40"/>
        <!-- HELPGOOD: cfg -->
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKHazDesWtrLim" operation="set" value="0.66"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKHazDesWetLim" operation="set" value="0.10"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKHazDesert" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKHazDesert" operation="set" value="1">
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="0"/>
          <requirement name="CVarCompare" cvar="fGSKShownWetnessPerc" operation="LT" value="@fGSKHazDesWetLim"/>
          <requirement name="StatComparePercCurrentToMax" stat="Water" operation="LTE" value="@fGSKHazDesWtrLim"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathDryHotTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="bGSKHazDesert" operation="Equals" value="1"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathDryHotTime" operation="subtract" value="14" help="was 7, somewhat slow">
          <requirement name="CVarCompare" cvar="bGSKHazDesert" operation="Equals" value="0"/>
          <requirement name="CVarCompare" cvar="fGSKFireHeatingMult" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathDryHotTime" operation="set" value="0">
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotTime" operation="LTE" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathDryHotLvl" operation="set" value="@iGSKNearDeathDryHotTime"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathDryHotLvl" operation="divide" value="60"/>
      </effect_group>
      <effect_group help="NoseBleed">
        <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="GTE" value="1"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKNoseBleedChk" operation="set" value="@fGSKBloodLoss"/>
        <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss add randomFloat(0.005,0.015)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,15)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.015)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=7611:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="randomFloat(0.005,0.015)"> -->
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="Equals" value="1"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss add randomFloat(0.005,0.015)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,15)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.015)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=7615:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="randomFloat(0.005,0.015)"> -->
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="Equals" value="2"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss add randomFloat(0.005,0.015)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,15)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.015)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=7619:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="randomFloat(0.005,0.015)"> -->
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="Equals" value="3"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss add randomFloat(0.005,0.015)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,15)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.015)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=7623:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="randomFloat(0.005,0.015)"> -->
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="Equals" value="4"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss add randomFloat(0.005,0.015)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,15)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.015)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=7627:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="randomFloat(0.005,0.015)"> -->
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="GTE" value="5"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ShowToolbeltMessage" message="[TNM] Too dry, your nose bleeds.">
          <requirement name="CVarCompare" cvar=".fGSKNoseBleedChk" operation="LT" value="@fGSKBloodLoss"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardWDryAirIndicator">
          <requirement name="!HasBuff" buff="buffGSKHazardWDryAirIndicator"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar="iGSKNearDeathDryHotLvl" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar="iGSKNearDeathDryHotTime" operation="set" value="0"/>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardWWetFreezingAndHunger27" name_key="FreezingHazard" icon="7dtdGskHazardSnow" description_key="buffGSKHazardWWetFreezingAndHungerDesc">
      <damage_type value="Cold"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathFreezingLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardWWetFreezingAndHunger27"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardWWetFreezingAndHunger27"/>
        <!-- HELPGOOD: cfg -->
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKHazSnoFodLim" operation="set" value="0.66"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKHazSnoWetLim" operation="set" value="0.10"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKHazSnoFatLim" operation="set" value="0.20"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingLvl" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKHWWetFod" operation="set" value="0"/>
        <!-- HELPGOOD: <requirements compare_type="or"> doestn work here? -->
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKHWWetFod" operation="set" value="1">
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="1"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKHWWetFod" operation="set" value="1">
          <requirement name="CVarCompare" cvar="fGSKShownWetnessPerc" operation="GT" value="@fGSKHazSnoWetLim"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKHWWetFod" operation="set" value="1">
          <requirement name="StatComparePercCurrentToMax" stat="Food" operation="LTE" value="@fGSKHazSnoFodLim"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="bGSKHWWetFod" operation="Equals" value="1"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="subtract" value="7">
          <requirement name="CVarCompare" cvar="bGSKHWWetFod" operation="Equals" value="0"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="bGSKHWWetFod" operation="Equals" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFZHeatingTmSub" operation="set" value="@fGSKFireHeatingMult"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFZHeatingTmSub" operation="multiply" value="3"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="subtract" value="@.fGSKFZHeatingTmSub"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNearDeathFreezingTime" operation="GTE" value="60"/>
        <requirement name="CVarCompare" cvar="fGSKFatStaminaBlockage" operation="GTE" value="@fGSKHazSnoFatLim"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="add" value="-60"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKFatStaminaBlockage" operation="subtract" value="@fGSKHazSnoFatLim"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="set" value="0">
          <requirement name="CVarCompare" cvar="iGSKNearDeathFreezingTime" operation="LT" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingLvl" operation="set" value="@iGSKNearDeathFreezingTime"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingLvl" operation="divide" value="60"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar="iGSKNearDeathFreezingLvl" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="set" value="0"/>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardousWMiasmaDirtyB45" icon="7dtdGskMiasma" icon_blink="true" hidden="false" remove_on_death="true" description_key="buffGSKHazardousWMiasmaDirtyBDesc" name_key="HazardousMiasma">
      <damage_type value="Toxic"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathMiasmaLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardousWMiasmaDirtyB45"/>
        <triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="fGSKMiasmaDirty"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardousWMiasmaDirtyB45"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="3200" help="after 3600 danger, needs to drop below 3200 for safety"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardousWMiasmaDirtyB45"/>
      </effect_group>
      <effect_group help="set miasma ND lvl">
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathMiasmaLvl" operation="set" value="0">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="3600"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathMiasmaLvl" operation="set" value="1">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="3600"/>
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="4300"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathMiasmaLvl" operation="set" value="2">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="4300"/>
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="5000"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathMiasmaLvl" operation="set" value="3">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="5000"/>
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="5700"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathMiasmaLvl" operation="set" value="4">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="5700"/>
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="6400"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathMiasmaLvl" operation="set" value="5">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="6400"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="add extra problems">
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffDysenteryCatchDrink">
          <requirement name="!HasBuff" buff="buffDysenteryMain"/>
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="@iGSKNearDeathMiasmaLvl"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="indicators. TODO add cfg activator to disable this in case the flies sound become too annoying">
        <requirement name="CVarCompare" cvar=".iGSKAllowMiasmaIndicator" operation="Equals" value="2"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AttachParticleEffectToEntity" particle="#@modfolder(0-XNPCCore):Resources/Bugs.unity3d?p_Flies0_X" local_offset="0,0.5,0.3" local_rotation="0,0,0" parent_transform="Origin">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="3000"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveParticleEffectFromEntity" particle="p_Flies0_X" compare_type="or">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="3000"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="Equals" value="3"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="AttachParticleEffectToEntity" particle="#@modfolder(0-XNPCCore):Resources/Bugs.unity3d?p_Flies_X" local_offset="0,0.5,0.3" local_rotation="0,0,0" parent_transform="Origin">
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="Equals" value="3"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveParticleEffectFromEntity" particle="p_Flies_X" compare_type="or">
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="LT" value="3"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="Equals" value="5"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="AttachParticleEffectToEntity" particle="#@modfolder(0-XNPCCore):Resources/Bugs.unity3d?p_Flies2_X" local_offset="0,0.5,0.3" local_rotation="0,0,0" parent_transform="Origin">
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="Equals" value="5"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveParticleEffectFromEntity" particle="p_Flies2_X">
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="LT" value="5"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardousWeather58" icon="7dtdGskHazardWeather" icon_blink="true" hidden="false" remove_on_death="true" description_key="buffGSKHazardousWeatherDesc" name_key="HazardousWeatherAndEnvironment">
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathHazadousWeatherLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardousWeather"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardousWeather"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="iGSKNDHWTime" operation="set" value="1">
          <requirement name="CVarCompare" cvar="iGSKNDHWTime" operation="LTE" value="0"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNDHWTime" operation="LTE" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathHazadousWeatherLvl" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardousWeather58"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathHazadousWeatherLvl" operation="set" value="@iGSKNDHWTime"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathHazadousWeatherLvl" operation="divide" value="60"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="set" value="300">
          <requirement name="CVarCompare" cvar="iGSKNDHWTime" operation="GT" value="300"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKNearDeath40" hidden="false" remove_on_death="true" icon="ui_game_symbol_near_death_trauma" icon_color="255,128,128" icon_blink="true" description_key="buffGSKNearDeathDesc" name_key="NearDeathLevels">
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeath"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
        <requirement name="!HasBuff" buff="buffGSKGodMode"/>
        <requirement name="!HasBuff" buff="god" help="TODO: why does not work?"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="0"/>
      </effect_group>
      <effect_group>
        <requirement name="!HasBuff" buff="buffGSKGodMode"/>
        <requirement name="!HasBuff" buff="god"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathLowCostTeleportLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathLowCostTeleportLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathCriticalHitLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathCriticalHitLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathPsyPowerLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathPsyPowerLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathBloodLossLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathBloodLossLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathMiasmaLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathMiasmaLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathFreezingLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathFreezingLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathDryHotLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathDryHotLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathRadiationLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathRadiationLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathPoisonLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathPoisonLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathHazadousWeatherLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathHazadousWeatherLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathFrostbyteLvl">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathFrostbyteLvl"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathBloated">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathBloated"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathOverhydrated">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathOverhydrated"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathChemUse">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathChemUse"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="@iGSKNearDeathRewindTime">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="@iGSKNearDeathRewindTime"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeath" operation="set" value="0">
          <requirement name="CVarCompare" cvar="iGSKNearDeathProtectionCBM" operation="Equals" value="1"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKNearDeath40">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="1"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fHWBlockageStamTmp" operation="set" value="28" help="max is 75% of this value, so 21"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fNearDeathBlockageStam" operation="set" value="0">
          <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="1"/>
        </triggered_effect>
      </effect_group>
      <!-- HELPGOOD: existing ModifyScreenEffect options (?) from resources.assets, read also Data/Config/XML.txt
				ISSUE: how is the bleeding ModifyScreenEffect applied? there is nothing there... could be thru the damage_type=bloodloss? TODO: use bleeding screen effect to hint when stepping over pointy fences, losing HP cuz of neardeath conditions or when using wight power. May be call a new buff buffInjuryBleedingMinor like buffInjuryBleedingOne but with bleedcounter=0.25 and force a duration of 1s only?
        AtDeath (MAYBE)
        Beer (no)
        Bright (no)
        Cold (no)
        Crouched
        Crouching
        Dark (weak)
        Death (MAYBE.no, only 1.0?)
        Drugs
        FireSmallLoop ?
        HalfHealth (may be?)
        Painkillers
        Spawn
        SpawnIn
        Stealth
        Tonemapping ?
        Vibrant
        VibrantDeSat (nice but too bright at 1.0)
      -->
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="GTE" value="1"/>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="2"/>
        <passive_effect name="RunSpeed" operation="perc_subtract" value="0.20"/>
        <passive_effect name="WalkSpeed" operation="perc_subtract" value="0.20"/>
        <passive_effect name="CrouchSpeed" operation="perc_subtract" value="0.20"/>
        <passive_effect name="AttacksPerMinute" operation="perc_subtract" value="0.15"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fHWBlockageStamTmp" operation="multiply" value="0.15"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKHPLossWithEffectIndicator" operation="add" value="-0.1"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.72" fade="5.0" compare_type="or" help="vibrant actually helps on darkening the screen. intensity was 0.80 but becomes too dark at night">
          <requirement name="InBiome" biome="3" help="desert5 snow1 forest3 wasteland8"/>
          <requirement name="InBiome" biome="8" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.76" fade="5.0" help="with 0.96 we cant see the floor at night on desert" compare_type="or">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.80" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="0.10" fade="5.0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Distortion" intensity="0.00" fade="5.0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="GTE" value="2"/>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="3"/>
        <passive_effect name="RunSpeed" operation="perc_subtract" value="0.40"/>
        <passive_effect name="WalkSpeed" operation="perc_subtract" value="0.40"/>
        <passive_effect name="CrouchSpeed" operation="perc_subtract" value="0.40"/>
        <passive_effect name="AttacksPerMinute" operation="perc_subtract" value="0.30"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fHWBlockageStamTmp" operation="multiply" value="0.30"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKHPLossWithEffectIndicator" operation="add" value="-0.15"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.75" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="3" help="desert5 snow1 forest3 wasteland8"/>
          <requirement name="InBiome" biome="8" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.84" fade="5.0" help="with 0.96 we cant see the floor at night on desert" compare_type="or">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.89" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="0.20" fade="5.0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Distortion" intensity="0.00" fade="5.0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="GTE" value="3"/>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="4"/>
        <passive_effect name="RunSpeed" operation="perc_subtract" value="0.60"/>
        <passive_effect name="WalkSpeed" operation="perc_subtract" value="0.60"/>
        <passive_effect name="CrouchSpeed" operation="perc_subtract" value="0.60"/>
        <passive_effect name="AttacksPerMinute" operation="perc_subtract" value="0.45"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fHWBlockageStamTmp" operation="multiply" value="0.45"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKHPLossWithEffectIndicator" operation="add" value="-0.2"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.78" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="3" help="desert5 snow1 forest3 wasteland8"/>
          <requirement name="InBiome" biome="8" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.88" fade="5.0" help="with 0.96 we cant see the floor at night on desert" compare_type="or">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.93" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="0.40" fade="5.0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Distortion" intensity="0.00" fade="5.0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="GTE" value="4"/>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="LT" value="5"/>
        <passive_effect name="RunSpeed" operation="perc_subtract" value="0.80"/>
        <passive_effect name="WalkSpeed" operation="perc_subtract" value="0.80"/>
        <passive_effect name="CrouchSpeed" operation="perc_subtract" value="0.80"/>
        <passive_effect name="AttacksPerMinute" operation="perc_subtract" value="0.60"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fHWBlockageStamTmp" operation="multiply" value="0.60"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKHPLossWithEffectIndicator" operation="add" value="-0.25"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.81" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="3" help="desert5 snow1 forest3 wasteland8"/>
          <requirement name="InBiome" biome="8" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.90" fade="5.0" help="with 0.96 we cant see the floor at night on desert" compare_type="or">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.95" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="1.00" fade="5.0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Distortion" intensity="0.00" fade="5.0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="iGSKNearDeath" operation="GTE" value="5"/>
        <passive_effect name="RunSpeed" operation="perc_subtract" value="0.90"/>
        <passive_effect name="WalkSpeed" operation="perc_subtract" value="0.90"/>
        <passive_effect name="CrouchSpeed" operation="perc_subtract" value="0.90"/>
        <passive_effect name="AttacksPerMinute" operation="perc_subtract" value="0.75"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fHWBlockageStamTmp" operation="multiply" value="0.75"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKHPLossWithEffectIndicator" operation="add" value="-0.33"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.84" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="3" help="desert5 snow1 forest3 wasteland8"/>
          <requirement name="InBiome" biome="8" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.92" fade="5.0" help="with 0.96 we cant see the floor at night on desert" compare_type="or">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.98" fade="5.0" compare_type="or">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="1.00" fade="5.0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Distortion" intensity="1.00" fade="5.0"/>
      </effect_group>
      <effect_group>
        <requirement name="!HasBuff" buff="buffGSKGodMode"/>
        <requirement name="!HasBuff" buff="god"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fNearDeathBlockageStam" operation="set" value="@.fHWBlockageStamTmp" help="must be set after calc on the tmp to prevent it varying"/>
        <passive_effect name="StaminaMaxBlockage" operation="base_add" value="@fNearDeathBlockageStam"/>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKNearDeath40" compare_type="or">
          <requirement name="HasBuff" buff="buffGSKGodMode"/>
          <requirement name="HasBuff" buff="god"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0" fade="10"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" effect_name="Drunk" intensity="0" fade="10"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" effect_name="Distortion" intensity="0" fade="10"/>
      </effect_group>
    </buff>
  </append>
  <append xpath="/buffs">
    <buff name="buffGSKHazardousWElementColdHook40" icon="7dtdGskHazardSnow" icon_blink="true" hidden="false" remove_on_death="true" name_key="HypothermyHazard" description_key="buffGSKHazardousWElementColdHookDESC">
      <damage_type value="Cold"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathFreezingLvl" help="create a buff to indicate iGSKNearDeathFrostbyteLvl lvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardousWElementColdHook40"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardousWElementColdHook40"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardousWElementColdHook40">
          <requirement name="CVarCompare" cvar="iGSKNDHWTime" operation="LTE" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LTE" value="-30"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-30"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="LTE" value="-20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-20"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-10"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="frostbyte is rare but may happen suddenly with a big value">
        <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="GT" value="99"/>
        <!--        HELPGOOD: by temperature-->
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.10)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.15)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.20)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.30)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-30"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.40)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-40"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.50)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-50"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.60)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-60"/>
        </triggered_effect>
        <!--        HELPGOOD: extra by wetness-->
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,0.50)">
          <requirement name="CVarCompare" cvar="fGSKShownWetnessPerc" operation="GTE" value="0.10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="add" value="randomFloat(0,1.0)">
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="1"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="0.333">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-30"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="0.333">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="0.333">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="6" help="from lvl 5 300s to lvl 1 60s is 240s/6=40s to recover. Heating, recovering from cold you need to be warm.">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="2">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="2">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="2">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="30"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKHWHeatingTmSub" operation="set" value="@fGSKFireHeatingMult"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKHWHeatingTmSub" operation="multiply" value="10"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="@.fGSKHWHeatingTmSub"/>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardousWElementHotHook40" icon="7dtdGskHazardDesert" icon_blink="true" hidden="false" remove_on_death="true" name_key="OverheatHazard" description_key="buffGSKHazardousWElementHotHookDESC">
      <damage_type value="Heat"/>
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <display_value value="iGSKNearDeathDryHotLvl"/>
      <display_value_key value="{0:0.0}/5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:buffGSKHazardousWElementHotHook40"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKHazardousWElementHotHook40"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardousWElementHotHook40">
          <requirement name="CVarCompare" cvar="iGSKNDHWTime" operation="LTE" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="10"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="20"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="30"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="add" value="1">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="30"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="sweating adds dirty">
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomFloat(1.5,3)" help="was 10to30, but it is per second, was too much.., miasma became a greater hazard than heat itself...">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomFloat(1.5,3)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomFloat(1.5,3)">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="30"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKFireHeatingMult" operation="Equals" value="0"/>
        <!-- HELPGOOD: this would actually cause a flu...
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="6">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-30" />
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="5">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-20" />
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="4">
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="-10" />
        </triggered_effect>
-->
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="4" help="from lvl 5 300s to lvl 1 60s is 240s/4=60s to recover. Cooling, recovering from warm, you CANNOT be too cold or you may get a flu.">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-10"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="2" help="Bonus for perfect temperature">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="-1"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="1"/>
        </triggered_effect>
        <!-- HELPGOOD:
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="0.333">
          <requirement name="CVarCompare" cvar="fGSKFireHeatingMult" operation="Equals" value="0" />
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="10" />
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="0.333">
          <requirement name="CVarCompare" cvar="fGSKFireHeatingMult" operation="Equals" value="0" />
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="20" />
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="0.333">
          <requirement name="CVarCompare" cvar="fGSKFireHeatingMult" operation="Equals" value="0" />
          <requirement name="CVarCompare" cvar="_coretemp" operation="LT" value="30" />
        </triggered_effect>
-->
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="_wetness" operation="GT" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKWetVsHeat" operation="set" value="@_wetness"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKWetVsHeat" operation="multiply" value="3.0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNDHWTime" operation="subtract" value="@.fGSKWetVsHeat"/>
      </effect_group>
    </buff>
    <buff name="buffGSKDenyGoreHarvest" hidden="true" remove_on_death="false" description_key="buffGSKDenyGoreHarvestDesc" name_key="GoreHarvest">
      <stack_type value="ignore"/>
      <duration value="0"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:STARTED:buffGSKDenyGoreHarvest"/>
        <triggered_effect trigger="onSelfBuffRemove" action="LogMessage" message="GSK:REMOVED:buffGSKDenyGoreHarvest"/>
        <passive_effect name="HarvestCount" operation="perc_subtract" level="0,1000" value="0.99" tags="butcherHarvest"/>
        <!--
				HELPGOOD: how to lower the 1st strike damage on a corpse? otherwise good butcher weapons will harvest almost nothing, only bad ones...
				<passive_effect name="BlockDamage" operation="perc_subtract" level="0,1000" value="0.90" tags="butcherHarvest" help="corpse bags?"/>
				<passive_effect name="EntityDamage" operation="perc_subtract" level="0,1000" value="0.90" tags="butcherHarvest" help="entities corpses?"/>
-->
      </effect_group>
    </buff>
    <buff name="buffGSKGoreHazard" hidden="false" icon="7dtdGskMiasma" icon_color="250,200,0" icon_blink="true" description_key="buffGSKGoreHazardDesc">
      <stack_type value="replace"/>
      <update_rate value="3"/>
      <duration value="5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="RemoveBuff" buff="buffGSKDenyGoreHarvest"/>
        <triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffGSKDenyGoreHarvest"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(150,300)" help="using strong strikes will lower this hazard effect"/>
        <triggered_effect help="FixTinyRandomFloat:was $buffStatusRadiation add randomFloat(0.1,0.3)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(100,300)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$buffStatusRadiation" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="blocks being hit apply a buff to entities but apparently these buffs cannot call other buffs? so see buffStatusCheck01 where buffRadiation01 is actually applied.;FixTinyRandomFloat: was randomFloat(0.1,0.3)"/>
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=8542:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$buffStatusRadiation" operation="add" value="randomfloat(0.1,0.3)" help="blocks being hit apply a buff to entities but apparently these buffs cannot call other buffs? so see buffStatusCheck01 where buffRadiation01 is actually applied."/> -->
      </effect_group>
    </buff>
    <buff name="buffGSKFlushMiasma" description_key="buffGSKFlushMiasmaDesc" name_key="FlushMiasmaAndDirt">
      <stack_type value="ignore"/>
      <duration value="3600"/>
      <update_rate value="1200"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <!-- HELPGOOD: if the player is just standing, the buff is just removed -->
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="0"/>
        <triggered_effect trigger="onSelfBuffStart" action="RemoveBuff" buff="buffGSKFlushMiasma"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="1"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="subtract" value="1800"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="subtract" value="randomfloat(10,20)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message_key="TooltipbuffGSKFlushMiasma"/>
      </effect_group>
    </buff>
    <buff name="buffGSKTakeBath">
      <stack_type value="ignore"/>
      <duration value="2"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="0"/>
        <triggered_effect trigger="onSelfBuffStart" action="RemoveBuff" buff="buffGSKTakeBath"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="1"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="subtract" value="180"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="subtract" value="randomfloat(1,2)">
          <requirement name="!InBiome" biome="8"/>
          <!-- HELPGOOD: wasteland -->
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="add" value="randomfloat(1,2)">
          <requirement name="InBiome" biome="8"/>
          <!-- HELPGOOD: wasteland -->
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message="[TNM] You take a good bath."/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="iGSKMiasmaBlockPercExtra" operation="add" value="0.025">
          <requirement name="CVarCompare" cvar="iGSKMiasmaBlockPercExtra" operation="LT" value="1.00"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKTakeCatBath">
      <stack_type value="ignore"/>
      <duration value="2"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="0"/>
        <triggered_effect trigger="onSelfBuffStart" action="RemoveBuff" buff="buffGSKTakeCatBath"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="1"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="subtract" value="60"/>
        <triggered_effect help="FixTinyRandomFloat:was $buffStatusRadiation subtract randomFloat(0.33,0.66)" trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(330,660)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="subtract" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.33,0.66)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=8641:        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="subtract" value="randomfloat(0.33,0.66)"> -->
          <requirement name="!InBiome" biome="8"/>
          <!-- HELPGOOD: wasteland -->
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was $buffStatusRadiation add randomFloat(0.33,0.66)" trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(330,660)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.33,0.66)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=8644:        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$buffStatusRadiation" operation="add" value="randomfloat(0.33,0.66)"> -->
          <requirement name="InBiome" biome="8"/>
          <!-- HELPGOOD: wasteland -->
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message="[TNM] You take a slow and relaxing bath like a cat :3"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="iGSKMiasmaBlockPercExtra" operation="add" value="0.01">
          <requirement name="CVarCompare" cvar="iGSKMiasmaBlockPercExtra" operation="LT" value="0.50"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKMiasmaEffectWeak" icon_blink="true" icon="7dtdGskMiasma" icon_color="250,100,0" hidden="false">
      <stack_type value="ignore"/>
      <duration value="1"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyScreenEffect" intensity="0.40" fade="1" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" intensity="0" fade="1" effect_name="Infected"/>
      </effect_group>
    </buff>
    <buff name="buffGSKMiasmaEffectA" icon="7dtdGskMiasma" icon_blink="true" icon_color="250,150,0" hidden="false">
      <stack_type value="ignore"/>
      <duration value="2"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyScreenEffect" intensity="0.60" fade="2" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" intensity="0" fade="2" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="player#vomit" play_in_head="true"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Water" operation="add" value="-1"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Food" operation="add" value="-1"/>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message_key="ToolTipMiasmaDmg"/>
      </effect_group>
    </buff>
    <buff name="buffGSKMiasmaEffectB" icon="7dtdGskMiasma" icon_blink="true" icon_color="250,150,0" hidden="false">
      <stack_type value="ignore"/>
      <duration value="4"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyScreenEffect" intensity="0.80" fade="4" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" intensity="0" fade="4" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="player#vomit" play_in_head="true"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Water" operation="add" value="-2"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Food" operation="add" value="-2"/>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message_key="ToolTipMiasmaDmg"/>
      </effect_group>
    </buff>
    <buff name="buffGSKMiasmaEffectC" icon="7dtdGskMiasma" icon_blink="true" icon_color="250,150,0" hidden="false">
      <stack_type value="ignore"/>
      <duration value="6"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyScreenEffect" intensity="1.00" fade="6" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffRemove" action="ModifyScreenEffect" intensity="0" fade="6" effect_name="Infected"/>
        <triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="player#vomit" play_in_head="true"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Water" operation="add" value="-3"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyStats" stat="Food" operation="add" value="-3"/>
        <triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message_key="ToolTipMiasmaDmg"/>
      </effect_group>
    </buff>
    <buff name="buffGSKCalcHeating" hidden="true" help="this cvar shall be used as a multiplier">
      <stack_type value="ignore"/>
      <duration value="0.05"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKFireHeatingMult" operation="set" value="0"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKFireHeatingMult" operation="set" value="2.5">
          <requirement name="HasBuff" buff="buffCampfireAOE"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKFireHeatingMult" operation="set" value="4.01">
          <requirement name="HasBuff" buff="buffBurningFlamingArrow"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKFireHeatingMult" operation="set" value="4.02">
          <requirement name="HasBuff" buff="buffBurningElement"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKFireHeatingMult" operation="set" value="4.03">
          <requirement name="HasBuff" buff="buffBurningEnvironment"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKFireHeatingMult" operation="set" value="6">
          <requirement name="HasBuff" buff="buffBurningMolotov"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKAllHazardsCheck40" hidden="true">
      <stack_type value="replace"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <!-- HELPGOOD: these buffs change the near death levels -->
      <effect_group help="hazard blood loss">
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardousWBloodLoss53">
          <requirement name="!HasBuff" buff="buffGSKGodMode"/>
          <requirement name="!HasBuff" buff="god"/>
          <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0.14"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="subtract" value="0.000005" help="it is like about healing 0.018 per day (1.8%) (0.000005*3600), natural regeneration"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="set" value="0">
          <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="LT" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLossShow" operation="set" value="@fGSKBloodLoss"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLossShow" operation="multiply" value="100"/>
      </effect_group>
      <!-- HELPGOOD: miasma&dirty 'iGSKNearDeathMiasmaLvl' tho is controlled by 'buffGSKHazardWeatherMiasmaDirty59' as it permanently happens everywhere -->
      <effect_group help="dry air">
        <requirement name="!HasBuff" buff="buffGSKGodMode"/>
        <requirement name="!HasBuff" buff="god"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardWDryness40" compare_type="or">
          <requirement name="InBiome" biome="5" help="desert"/>
          <requirement name="InBiome" biome="8" help="wasteland"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="dry air">
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardWDryness40">
          <requirement name="!InBiome" biome="5" help="desert"/>
          <requirement name="!InBiome" biome="8" help="wasteland"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="freezing: in snow. in wasteland at night only">
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardWWetFreezingAndHunger27">
          <requirement name="!HasBuff" buff="buffGSKGodMode"/>
          <requirement name="!HasBuff" buff="god"/>
          <requirement name="InBiome" biome="1" help="snow"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardWWetFreezingAndHunger27">
          <requirement name="!HasBuff" buff="buffGSKGodMode"/>
          <requirement name="!HasBuff" buff="god"/>
          <requirement name="InBiome" biome="8" help="wasteland"/>
          <requirement name="IsNight"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardWWetFreezingAndHunger27">
          <requirement name="!InBiome" biome="1" help="snow"/>
          <requirement name="!InBiome" biome="8" help="wasteland"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKHazardWWetFreezingAndHunger27">
          <requirement name="InBiome" biome="8" help="wasteland"/>
          <requirement name="!IsNight"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKCalcHeating"/>
      </effect_group>
      <effect_group help="you would need to overheat to cure frostbyte faster">
        <requirement name="CVarCompare" cvar="iGSKNearDeathFrostbyteLvl" operation="GT" value="0"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="subtract" value="0.0166" help="takes at least 60s to cure each level">
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKHeatingLvlSubRandomChk" operation="set" value="@fGSKFireHeatingMult"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKHeatingLvlSubRandomChk" operation="multiply" value="10"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKHeatingLvlSub" operation="set" value="@fGSKFireHeatingMult"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKHeatingLvlSub" operation="multiply" value="0.05" help="near a campfire that is mult 2.5, will be lvl-=0.125, will result in 40s to cure all 5 levels, because of update_rate 1s if random success">
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="@.fGSKHeatingLvlSubRandomChk"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="subtract" value="@.fGSKHeatingLvlSub"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="subtract" value="randomFloat(0,0.25)">
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="10"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="GT" value="3"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="subtract" value="randomFloat(0,0.25)">
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="20"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="10"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="subtract" value="randomFloat(0,0.25)">
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="35"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="20"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="subtract" value="randomFloat(0,0.25)">
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="50"/>
          <requirement name="CVarCompare" cvar="_coretemp" operation="GTE" value="30"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFrostbyteLvl" operation="set" value="0">
          <requirement name="CVarCompare" cvar="iGSKNearDeathFrostbyteLvl" operation="LT" value="0"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardousWRadiation40">
          <requirement name="!HasBuff" buff="buffGSKGodMode"/>
          <requirement name="!HasBuff" buff="god"/>
          <requirement name="NotHasBuff" buff="buffGSKHazardousWRadiation40"/>
          <requirement name="CVarCompare" cvar="$buffStatusRadiation" operation="GT" value="20"/>
        </triggered_effect>
      </effect_group>
      <!-- HELPGOOD: 'iGSKNearDeathPoisonLvl' is controlled by 'buffGSKSnakePoisonWork55' -->
      <effect_group>
        <requirements compare_type="or">
          <requirement name="CVarCompare" cvar="iGSKNearDeathLowCostTeleportLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathCriticalHitLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathPsyPowerLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathBloodLossLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathMiasmaLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathDryHotLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathFreezingLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathRadiationLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathPoisonLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathHazadousWeatherLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathFrostbyteLvl" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathBloated" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathOverhydrated" operation="GTE" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKNearDeathChemUse" operation="GTE" value="1"/>
        </requirements>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKNearDeath40">
          <requirement name="!HasBuff" buff="buffGSKGodMode"/>
          <requirement name="!HasBuff" buff="god"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKHeatColdProtClothDmgAdd32" hidden="true" remove_on_death="false">
      <stack_type value="replace"/>
      <duration value="0.05"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group>
        <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8. cuz of the probability of wearing coherent weather prot"/>
        <triggered_effect help="FixTinyRandomFloat:was fGSKDmgHeatProt add randomFloat(0.005,0.050)" trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,50)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.050)"/>
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=4849:        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="add" value="randomFloat(0.005,0.050)"/> -->
        <triggered_effect help="FixTinyRandomFloat:was fGSKDmgHeatProt add randomFloat(0.05,0.20)" trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(50,200)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.05,0.20)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=4850:        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="add" value="randomFloat(0.05,0.20)"> -->
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8. cuz of the probability of wearing coherent weather prot"/>
        <triggered_effect help="FixTinyRandomFloat:was fGSKDmgColdProt add randomFloat(0.005,0.050)" trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(5,50)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.005,0.050)"/>
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=4854:        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="add" value="randomFloat(0.005,0.050)"/> -->
        <triggered_effect help="FixTinyRandomFloat:was fGSKDmgColdProt add randomFloat(0.05,0.20)" trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(50,200)"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.05,0.20)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=4855:        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="add" value="randomFloat(0.05,0.20)"> -->
          <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LTE" value="5"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKHeatColdProtClothDmgKeep32" hidden="true" remove_on_death="false">
      <stack_type value="replace"/>
      <duration value="0"/>
      <update_rate value="5"/>
      <requirements>
        <requirement name="EntityTagCompare" tags="player"/>
      </requirements>
      <effect_group help="natural degradation">
        <requirement name="EntityHasMovementTag" tags="running"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$fGSKDmgHeatProtTMP" operation="set" value="randomInt(3,10)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$fGSKDmgHeatProtTMP" operation="divide" value="10000"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="add" value="@$fGSKDmgHeatProtTMP">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8. cuz of the probability of wearing coherent weather prot"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="add" value="@$fGSKDmgHeatProtTMP">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8. cuz of the probability of wearing coherent weather prot"/>
        </triggered_effect>
      </effect_group>
      <effect_group help="natural degradation">
        <requirement name="!EntityHasMovementTag" tags="running"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$fGSKDmgHeatProtTMP" operation="set" value="randomInt(0,2)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$fGSKDmgHeatProtTMP" operation="divide" value="10000"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="add" value="@$fGSKDmgHeatProtTMP">
          <requirement name="InBiome" biome="5" help="desert5 snow1 forest3 wasteland8. cuz of the probability of wearing coherent weather prot"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="add" value="@$fGSKDmgHeatProtTMP">
          <requirement name="InBiome" biome="1" help="desert5 snow1 forest3 wasteland8. cuz of the probability of wearing coherent weather prot"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="set" value="0">
          <requirement name="CVarCompare" cvar="fGSKDmgHeatProt" operation="LT" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgHeatProt" operation="set" value="1.00">
          <requirement name="CVarCompare" cvar="fGSKDmgHeatProt" operation="GT" value="1.00"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="set" value="0">
          <requirement name="CVarCompare" cvar="fGSKDmgColdProt" operation="LT" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKDmgColdProt" operation="set" value="1.00">
          <requirement name="CVarCompare" cvar="fGSKDmgColdProt" operation="GT" value="1.00"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKDmgColdProtx100" operation="set" value="@fGSKDmgColdProt"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKDmgColdProtx100" operation="multiply" value="100"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKDmgHeatProtx100" operation="set" value="@fGSKDmgHeatProt"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKDmgHeatProtx100" operation="multiply" value="100"/>
      </effect_group>
      <effect_group>
        <passive_effect name="HypothermalResist" operation="perc_subtract" value="@fGSKDmgColdProt">
          <requirement name="CVarCompare" cvar="fGSKDmgColdProt" operation="GT" value="0"/>
        </passive_effect>
        <passive_effect name="HyperthermalResist" operation="perc_subtract" value="@fGSKDmgHeatProt">
          <requirement name="CVarCompare" cvar="fGSKDmgHeatProt" operation="GT" value="0"/>
        </passive_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKHazardWeatherMiasmaDirty59" hidden="true" description_key="buffGSKHazardWeatherMiasmaDirtyDesc" name_key="MiasmaAndDirty" help="permanent buff, there is miasma everywhere">
      <stack_type value="replace"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <effect_group help="add miasma">
        <requirement name="CVarCompare" cvar="_sheltered" operation="LT" value="1.00"/>
        <triggered_effect help="FixTinyRandomFloat:was fGSKMiasmaDirty add randomFloat(0.0,0.1)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(0,100)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.0,0.1)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=14082:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(0.0,0.1)"> -->
          <requirement name="InBiome" biome="1"/>
          <!-- HELPGOOD: snow -->
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKMiasmaDirty add randomFloat(0.0,0.2)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(0,200)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.0,0.2)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=14085:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(0.0,0.2)"> -->
          <requirement name="InBiome" biome="5"/>
          <!-- HELPGOOD: desert -->
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKMiasmaDirty add randomFloat(0.0,0.35)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(0,350)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.0,0.35)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=14088:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(0.0,0.35)"> -->
          <requirement name="InBiome" biome="8"/>
          <!-- HELPGOOD: wasteland -->
        </triggered_effect>
        <triggered_effect help="FixTinyRandomFloat:was fGSKMiasmaDirty add randomFloat(0.0,0.3)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(0,300)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.0,0.3)">
          <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=14091:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(0.0,0.3)"> -->
          <requirement name="InBiome" biome="9"/>
          <!-- HELPGOOD: burntforest (TODO: make it work like in desert about hazards)-->
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(1.5,3.5)">
          <requirement name="InBiome" biome="3"/>
          <!-- HELPGOOD: pineforest (as desert and snow have each 2 hazards, it is much higher here) -->
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(3.0,6.0)">
          <requirement name="InBiome" biome="13"/>
          <!-- HELPGOOD: cavefloor -->
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="randomfloat(5,10)">
          <requirement name="InBiome" biome="14"/>
          <!-- HELPGOOD: caveceiling fetid gases accumulating there -->
        </triggered_effect>
      </effect_group>
      <effect_group help="bathing underwater or rain or just wet">
        <requirements compare_type="or">
          <requirement name="CVarCompare" cvar="fGSKShownWetnessPerc" operation="GT" value="0"/>
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="1"/>
        </requirements>
        <triggered_effect trigger="onSelfBuffUpdate" action="ShowToolbeltMessage" message_key="TooltipBuffGSKHazardWeatherMiasmaDirty4Bath">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="10"/>
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="1"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKCleanTheDirty" operation="set" value="360"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKCleanTheDirty" operation="multiply" value="@fGSKShownWetnessPerc">
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKCleanTheDirty" operation="divide" value="30">
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="subtract" value="@fGSKCleanTheDirty"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaBlockPercExtra" operation="add" value="0.20">
          <requirement name="CVarCompare" cvar="iGSKMiasmaBlockPercExtra" operation="LT" value="3.5" help="this kind of bath will last more"/>
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="1"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaBlockPercExtra" operation="add" value="0.10">
          <requirement name="CVarCompare" cvar="iGSKMiasmaBlockPercExtra" operation="LT" value="0.75" help="like between cat bath and normal bath"/>
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKBathMsgCooldownTime" operation="set" value="120">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="0"/>
          <requirement name="CVarCompare" cvar="_underwater" operation="Equals" value="1"/>
          <requirement name="CVarCompare" cvar="iGSKBathMsgCooldownTime" operation="LTE" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ShowToolbeltMessage" message_key="TooltipBuffGSKHazardWeatherMiasmaDirty4Cleaned">
          <requirement name="CVarCompare" cvar="iGSKBathMsgCooldownTime" operation="Equals" value="120"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKBathMsgCooldownTime" operation="subtract" value="1">
          <requirement name="CVarCompare" cvar="iGSKBathMsgCooldownTime" operation="GT" value="0"/>
        </triggered_effect>
      </effect_group>
      <!-- HELPGOOD: TODO: bash script this code to generate stages easily -->
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LT" value="3300"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectA" operation="set" value="0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GTE" value="3300"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKMiasmaEffectA">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectA" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectA" operation="set" value="100">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectA" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectA" operation="subtract" value="1">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectA" operation="GT" value="0"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LT" value="3580"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectB" operation="set" value="0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GTE" value="3580"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKMiasmaEffectB">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectB" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectB" operation="set" value="75">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectB" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectB" operation="subtract" value="1">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectB" operation="GT" value="0"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LT" value="4800"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectC" operation="set" value="0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GTE" value="4800"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKMiasmaEffectC">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectC" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectC" operation="set" value="60">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectC" operation="Equals" value="0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKMiasmaEffectC" operation="subtract" value="1">
          <requirement name="CVarCompare" cvar="iGSKMiasmaEffectC" operation="GT" value="0"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LTE" value="3600"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKMiasmaDirtyTooMuch" operation="set" value="0"/>
      </effect_group>
      <effect_group>
        <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="3600"/>
        <!-- HELPGOOD: like 1 baths a day -->
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="bGSKMiasmaDirtyTooMuch" operation="set" value="1"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKHazardousWMiasmaDirtyB45">
          <requirement name="NotHasBuff" buff="buffGSKHazardousWMiasmaDirtyB45"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="set" value="7200">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="GT" value="7200"/>
        </triggered_effect>
      </effect_group>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="set" value="0">
          <requirement name="CVarCompare" cvar="fGSKMiasmaDirty" operation="LT" value="0"/>
        </triggered_effect>
      </effect_group>
    </buff>
  </append>
  <append xpath="/buffs/buff[@name='buffGSKPermanentGenericCheck21']">
    <effect_group help="FAT: rm screff. place b4 adding on next group">
      <requirement name="CVarCompare" cvar=".iGSKFatClearScrEff" operation="Equals" value="1"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="0" fade="2.5"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Blur" intensity="0" fade="2.5"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0" fade="2.5"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".iGSKFatClearScrEff" operation="set" value="0"/>
    </effect_group>
    <effect_group help="FAT: extra fat helps on avoiding death by starvation too">
      <requirement name="StatComparePercCurrentToMax" stat="Food" operation="LTE" value="0.04" help="the inverse check at buffStatusHungry03(starvation) to add buffStatusHungry02 that will end removing buffStatusHungry03"/>
      <requirement name="CVarCompare" cvar="fGSKFatStaminaBlockage" operation="GTE" value="0.1"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKFatStaminaBlockage" operation="add" value="-0.10"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="food" operation="add" value="1"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".bGSKStarvingSideEffectsApplyNow" operation="set" value="1"/>
    </effect_group>
    <effect_group help="STARVING:without fat:countDown">
      <requirement name="CVarCompare" cvar=".bGSKStarvingSideEffectsApplyNow" operation="Equals" value="0"/>
      <requirement name="HasBuff" buff="buffStatusHungry03" help="starving w/o fat. kicks in with Food LTE 0.02"/>
      <requirement name="StatComparePercCurrentToMax" stat="Food" operation="LT" value="0.01"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKStarvingSideEffectsCountdown" operation="add" value="-1">
        <requirement name="CVarCompare" cvar="iGSKStarvingSideEffectsCountdown" operation="GT" value="0"/>
      </triggered_effect>
    </effect_group>
    <effect_group help="STARVING:without fat:activate bad effects">
      <requirement name="CVarCompare" cvar=".bGSKStarvingSideEffectsApplyNow" operation="Equals" value="0"/>
      <requirement name="HasBuff" buff="buffStatusHungry03" help="starving w/o fat. kicks in with Food LTE 0.02"/>
      <requirement name="StatComparePercCurrentToMax" stat="Food" operation="LT" value="0.01" help="must be less than buffStatusHungry03 trigger value 0.02"/>
      <requirement name="CVarCompare" cvar="iGSKStarvingSideEffectsCountdown" operation="Equals" value="0"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".bGSKStarvingSideEffectsApplyNow" operation="set" value="1"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKStarvingSideEffectsCountdown" operation="set" value="60"/>
    </effect_group>
    <effect_group help="STARVING:bad effects (with or without fat)">
      <requirement name="CVarCompare" cvar=".bGSKStarvingSideEffectsApplyNow" operation="Equals" value="1"/>
      <!-- HELPGOOD:GOOD EFFECTS: -->
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="subtract" value="0.05" help="starving will help cure the body by eliminating weak cells faster (weak and sick cells will die first in a starving body)">
        <requirement name="CVarCompare" cvar="fGSKHitpointsBlockageChemUse" operation="GT" value="0"/>
      </triggered_effect>
      <!-- HELPGOOD:BAD EFFECTS: it is not free food, there is side effects. the ND values, if you are taking care it wont cause trouble, but if you are on the limit it will be a problem, these are only meant to worsen an existing problem, not to create it out of thin air. The screen effects will all be fixed by the ND main buff if they every happen. -->
      <triggered_effect trigger="onSelfBuffUpdate" action="CVarLogValue" cvar="fGSKStarvingDebuffTime">
        <requirement name="CVarCompare" cvar="fGSKStarvingDebuffTime" operation="GTE" value="1"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKStarvingDebuffTime" operation="set" value="60"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="water" operation="add" value="-1"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="0.000016667" help="1% every 10mins (at update_rate of 1s)"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathDryHotTime" operation="add" value="30">
        <requirement name="InBiome" biome="5" help="desert" compare_type="or"/>
        <requirement name="InBiome" biome="8" help="Wasteland"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKNearDeathFreezingTime" operation="add" value="30">
        <requirement name="InBiome" biome="1" help="snow" compare_type="or"/>
        <requirement name="InBiome" biome="8" help="Wasteland"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKMiasmaDirty" operation="add" value="300" help="pine forest strong miasma will be worse in a starving person">
        <requirement name="InBiome" biome="3" help="PineForest"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$buffStatusRadiation" operation="add" value="1" help="max rads is 100.0. Starving will make the body weaker vs radiation.">
        <requirement name="InBiome" biome="8" help="Wasteland"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".iGSKStarvFallDown" operation="set" value="1">
        <requirement name="CVarCompare" cvar="_crouching" operation="Equals" value="0"/>
        <requirement name="RandomRoll" seed_type="Random" min_max="0,100" operation="LT" value="5"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="CallGameEvent" event="eventGSKPlayerRagdoll">
        <requirement name="CVarCompare" cvar=".iGSKStarvFallDown" operation="GTE" value="1"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ShowToolbeltMessage" message="[TNM] Starving.. weak legs.. fall down..">
        <requirement name="CVarCompare" cvar=".iGSKStarvFallDown" operation="GTE" value="1"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".iGSKStarvFallDown" operation="set" value="0"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Drunk" intensity="0.10" fade="0.5"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Blur" intensity="0.10" fade="0.5"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyScreenEffect" effect_name="Vibrant" intensity="0.72" fade="0.5"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKHPLossWithEffectIndicator" operation="add" value="-0.33" help="some value near to letting almost no healing happen if feeding only on remaining fat. sync with update_rate"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Stamina" operation="add" value="-100">
        <requirement name="!HasBuff" buff="buffGSKWightEssence" help="otherwise this would just end almost killing the player by converting HP into stamina, and seems cool having that power affect this too"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="PlaySound" sound="Player$Hungry" play_in_head="true"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".iGSKFatClearScrEff" operation="set" value="1"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKExpDebt" operation="add" value="120" help="sync with 2x this starvation check delay iGSKStarvingSideEffectsCountdown, but this may happen more often depending on fat consumption rate (to counter starvation)"/>
      <triggered_effect help="FixTinyRandomFloat:was fGSKStarvingHPBlockage add randomFloat(0.33,1.0)" trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(330,1000)"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKStarvingHPBlockage" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.33,1.0)">
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=15824:        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKStarvingHPBlockage" operation="add" value="randomFloat(0.33,1.0)"> -->
        <requirement name="CVarCompare" cvar="fGSKStarvingHPBlockage" operation="LT" value="@.fGSKStarvingHPBlockageLimit"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKEssenceMutant" operation="add" value="-0.01">
        <requirement name="CVarCompare" cvar="iGSKEssenceMutant" operation="GTE" value="0.01"/>
        <requirement name="HasBuff" buff="buffStatusHungry03" help="starving w/o fat. kicks in with Food LTE 0.02"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKEssenceVampire" operation="add" value="-0.01">
        <requirement name="CVarCompare" cvar="iGSKEssenceVampire" operation="GTE" value="0.01"/>
        <requirement name="HasBuff" buff="buffStatusHungry03" help="starving w/o fat. kicks in with Food LTE 0.02"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKEssenceWight" operation="add" value="-0.01">
        <requirement name="CVarCompare" cvar="iGSKEssenceWight" operation="GTE" value="0.01"/>
        <requirement name="HasBuff" buff="buffStatusHungry03" help="starving w/o fat. kicks in with Food LTE 0.02"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKStarvingFatigueCountdown" operation="set" value="randomInt(20,30)" compare_type="or" help="this is about the many times .bGSKStarvingSideEffectsApplyNow happens, so may take a long time">
        <requirement name="HasBuff" buff="buffDrugVitamins"/>
        <requirement name="CVarCompare" cvar="iGSKStarvingFatigueCountdown" operation="Equals" value="0"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffFatigued">
        <requirement name="!HasBuff" buff="buffDrugVitamins"/>
        <requirement name="CVarCompare" cvar="iGSKStarvingFatigueCountdown" operation="Equals" value="1" help="trigger on 1 because 0 is default (1st iteration) and restart counter hint"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKStarvingFatigueCountdown" operation="add" value="-1">
        <requirement name="!HasBuff" buff="buffDrugVitamins"/>
      </triggered_effect>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".bGSKStarvingSideEffectsApplyNow" operation="set" value="0"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ShowToolbeltMessage" message="[TNM] Starving consumes your body fat and makes you tired."/>
    </effect_group>
    <effect_group help="STARVING:bad passive effects (with or without fat)">
      <requirement name="CVarCompare" cvar="fGSKStarvingDebuffTime" operation="GTE" value="1"/>
      <passive_effect name="CraftingTime" operation="perc_add" value="0.5" help="slower crafting if starving"/>
      <passive_effect name="RunSpeed" operation="perc_subtract" value="0.15"/>
      <passive_effect name="WalkSpeed" operation="perc_subtract" value="0.15"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKStarvingDebuffTime" operation="add" value="-1" help="sync with update_rate"/>
    </effect_group>
    <effect_group help="FEEDING: not starving anymore, not using fat">
      <!--        HELPGOOD:
        buffStatusHungry03 is LTE 02%. GT 0.04 there adds buffStatusHungry02 that removes buffStatusHungry03
        buffStatusHungry02 is LTE 25%
        buffStatusHungry01 is LTE 50% 
-->
      <requirement name="StatComparePercCurrentToMax" stat="Food" operation="GT" value="0.07" help="must be more than GT 0.04 to compensate the food add 1 from fat"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKStarvingFatigueCountdown" operation="set" value="0"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKStarvingSideEffectsCountdown" operation="set" value="0"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="fGSKStarvingDebuffTime" operation="set" value="0"/>
    </effect_group>
  </append>
</GhussakTweaks>
