<?xml version="1.0"?>
<GhussakTweaks>
  <append xpath="/items/item[@name='medicalBloodBag']">
    <property class="Action0">
      <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0"/>
      <property name="Class" value="Eat"/>
      <property name="Delay" value="1.0"/>
      <property name="Use_time" value="..."/>
      <property name="Sound_start" value="player_ointment"/>
    </property>
    <effect_group tiered="false">
      <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss subtract randomFloat(0.12,0.16)" trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(120,160)"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKBloodLoss" operation="subtract" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.12,0.16)"/>
      <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=20764:      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKBloodLoss" operation="subtract" value="randomFloat(0.12,0.16)"/> -->
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKBloodLoss" operation="set" value="0">
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="LT" value="0"/>
      </triggered_effect>
    </effect_group>
  </append>
  <append xpath="/items">
    <item name="medicalBloodBagEmpty">
      <property name="DescriptionKey" value="dkGSKmedicalBloodBagEmpty"/>
      <property name="CustomIcon" value="medicalBloodBag"/>
      <property name="CustomIconTint" value="70,70,70"/>
      <property name="Tags" value="medical"/>
      <property name="DisplayType" value="medical"/>
      <property name="HoldType" value="31"/>
      <property name="Meshfile" value="@:Other/Items/Health/bandage.fbx"/>
      <property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
      <property name="Material" value="Mmetal"/>
      <property name="Weight" value="5"/>
      <property name="SellableToTrader" value="false"/>
      <property name="Stacknumber" value="60"/>
      <property name="EconomicValue" value="1"/>
      <property class="Action0">
        <requirement name="NotHasBuff" buff="buffGSKGodMode"/>
        <requirement name="NotHasBuff" buff="buffGSKCosmicBloodMoon7"/>
        <requirement name="NotHasBuff" buff="buffGSKDeusExFriendlyIsNearbyPLAYERBUFF"/>
        <property name="Class" value="Eat"/>
        <property name="Delay" value="1.0"/>
        <property name="Use_time" value="..."/>
        <property name="Sound_start" value="player_ointment"/>
        <property name="Create_item" value="medicalBloodBag"/>
      </property>
      <property name="Group" value="Science,CFChemicals,Medical"/>
      <effect_group tiered="false">
        <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyStats" stat="Health" operation="add" value="-14.0"/>
        <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKBloodLoss" operation="add" value="0.01"/>
        <triggered_effect trigger="onSelfPrimaryActionEnd" action="AddBuff" buff="buffGSKHazardousWBloodLoss53"/>
        <triggered_effect trigger="onSelfPrimaryActionEnd" action="AddBuff" buff="buffInjuryStunned01"/>
      </effect_group>
    </item>
  </append>
  <append xpath="/items/item[starts-with(@name,'food')]" help="rationale: anything you use to feed">
    <effect_group name="regen a bit of blood loss" tiered="false">
      <triggered_effect help="FixTinyRandomFloat:was fGSKBloodLoss subtract randomFloat(0.001,0.002)" trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(1,2)"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKBloodLoss" operation="subtract" value="@.fGSKFixTinyRandomFloatTmp" help="TODO? could alternatively heal a tiny bit every time food bar is consumed;FixTinyRandomFloat: was randomFloat(0.001,0.002)">
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=5:			<triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKBloodLoss" operation="subtract" value="randomFloat(0.001,0.002)" help="TODO? could alternatively heal a tiny bit every time food bar is consumed"> -->
        <requirement name="CVarCompare" cvar="fGSKBloodLoss" operation="GT" value="0.0"/>
      </triggered_effect>
    </effect_group>
  </append>
  <!-- HELPGOOD: ================================================================
		tweaks for fGSKHitpointsBlockageChemUse
	-->
  <!-- HELPGOOD:
		do not for these:
			@name='drugGSKsnakePoisonAntidote' it is an antidote that is 100% good (right?)
			@name='medicalBloodBagEmpty' it is just a blood bag, no chem on it
			
		CODEGEN:HELPER: clear;egrep '<item name="(drug|med|food)[^" ]*"' ../* -iRIwho -\-include="items.xml" 2>/dev/null |sort -u |egrep -v "Schem|Desc|Admin" |sed -r 's#<item name=(.*)#@name=\1 or#' |tr '"' "'"
	-->
  <append xpath="/items/item[    @name='GSKsimpleBeer'         or    @name='drinkJarBeer'          or    @name='drugAtomJunkies'       or    @name='drugCovertCats'        or    @name='drugEyeKandy'          or    @name='drugFortBites'         or    @name='drugGSKAntiRadiation'        or    @name='drugGSKmutantEssence'        or    @name='drugGSKPsyonicsResist'       or    @name='drugGSKRadiationResist'      or    @name='drugGSKvampireEssence'       or    @name='drugGSKwightEssence'         or    @name='drugHackers'           or    @name='drugJailBreakers'      or    @name='drugNerdTats'          or    @name='drugOhShitzDrops'      or    @name='drugRecog'             or    @name='drugRockBusters'       or    @name='drugSkullCrushers'     or    @name='drugSugarButts'        or    @name='resourceAnimalFat'        ]" help="rationale: dmg inc and dmgres inc and extra powers or anesthesics, anything that could be considered unnatural or harmful in some way">
    <effect_group name="ADD chem use hp block" tiered="false">
      <triggered_effect help="FixTinyRandomFloat:was fGSKHitpointsBlockageChemUse add randomFloat(0.01,0.02)" trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(10,20)"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.01,0.02)"/>
      <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=21172:      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="add" value="randomFloat(0.01,0.02)"/> -->
    </effect_group>
  </append>
  <append xpath="/items/item[    @name='drugGSKAntiRadiationSlow'    or    @name='drugGSKAntiRadiationStrong'  or    @name='drugSteroids'                or    @name='resourceAnimalFatBall'          ]" help="rationale: dmg inc and dmgres inc and extra powers or anesthesics, anything that could be considered unnatural or harmful in some way">
    <effect_group name="ADD chem use hp block" tiered="false">
      <triggered_effect help="FixTinyRandomFloat:was fGSKHitpointsBlockageChemUse add randomFloat(0.025,0.050)" trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(25,50)"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="add" value="@.fGSKFixTinyRandomFloatTmp" help="despite many times stronger, these are cooked therefore improved so wont be too high chem block here.;FixTinyRandomFloat: was randomFloat(0.025,0.050)"/>
      <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=21182:      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="add" value="randomFloat(0.025,0.050)" help="despite many times stronger, these are cooked therefore improved so wont be too high chem block here."/> -->
    </effect_group>
  </append>
  <!-- HELPGOOD: do not for these
			@name='medicalPlasterCast'      # no chem on it
			@name='medicalSplint'           # no chem on it
			@name='drinkJarGrandpasForgettingElixir' # ?
			@name='drinkJarGrandpasLearningElixir' # ?
			@name='drinkJarGrandpasMoonshine' # ?
-->
  <append xpath="/items/item[    @name='drinkJarBlackStrapCoffee' or    @name='drinkJarBoiledWater'     or    @name='drinkJarCoffee' or    @name='drinkJarGoldenRodTea' or    @name='drinkJarGrandpasAwesomeSauce' or    @name='drinkJarPureMineralWater' or    @name='drinkJarRedTea'         or    @name='drinkJarYuccaCocktail'       or    @name='drinkJarYuccaJuice'          or    @name='drugAntibiotics'         or    @name='drugHealthBar'           or    @name='drugHerbalAntibiotics'   or    @name='drugPainkillers'         or    @name='drugVitamins'            or    @name='medicalAloeCream'        or    @name='medicalBandage'          or    @name='medicalBloodBag'         or    @name='medicalFirstAidBandage'  or    starts-with(@name,'food')   ]" help="rationale: anything ingestible that is used to actively heal or feed">
    <effect_group name="SUB chem use hp block: weak" tiered="false">
      <triggered_effect help="FixTinyRandomFloat:was fGSKHitpointsBlockageChemUse subtract randomFloat(0.025,0.050)" trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(25,50)"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="subtract" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.025,0.050)">
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=21233:      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="subtract" value="randomFloat(0.025,0.050)"> -->
        <requirement name="CVarCompare" cvar="fGSKHitpointsBlockageChemUse" operation="GT" value="0.0"/>
      </triggered_effect>
    </effect_group>
  </append>
  <append xpath="/items/item[    @name='medicalFirstAidKit'        ]" help="rationale: professional direct healing intent">
    <effect_group name="SUB chem use hp block: good" tiered="false">
      <triggered_effect help="FixTinyRandomFloat:was fGSKHitpointsBlockageChemUse subtract randomFloat(0.15,0.33)" trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="set" value="randomInt(150,330)"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar=".fGSKFixTinyRandomFloatTmp" operation="divide" value="1000" help="FixTinyRandomFloat"/>
      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="subtract" value="@.fGSKFixTinyRandomFloatTmp" help="FixTinyRandomFloat: was randomFloat(0.15,0.33)">
        <!-- HELPGOOD:FixTinyRandomFloat:OriginalLineData:LineNumber=21242:      <triggered_effect trigger="onSelfPrimaryActionEnd" action="ModifyCVar" cvar="fGSKHitpointsBlockageChemUse" operation="subtract" value="randomFloat(0.15,0.33)"> -->
        <requirement name="CVarCompare" cvar="fGSKHitpointsBlockageChemUse" operation="GT" value="0.0"/>
      </triggered_effect>
    </effect_group>
  </append>
</GhussakTweaks>
