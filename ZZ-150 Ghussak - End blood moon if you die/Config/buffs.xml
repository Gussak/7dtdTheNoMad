<?xml version="1.0"?>
<GhussakTweaks>
  <append xpath="/buffs">
    <buff name="buffGSKendBloodMoon1" hidden="false" remove_on_death="false" icon="7dtdShockTip" icon_color="255,255,0" icon_blink="true">
      <stack_type value="ignore"/>
      <duration value="0"/>
      <update_rate value="0.05"/>
      <effect_group>
        <requirement name="IsBloodMoon"/>
        <triggered_effect trigger="onSelfBuffStart" action="LogMessage" message="GSK:START:'buffGSKendBloodMoon1'"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="CallGameEvent" event="eventGSKadvanceTimeOnce"/>
      </effect_group>
      <effect_group>
        <requirement name="!IsBloodMoon"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="LogMessage" message="GSK:END:'buffGSKendBloodMoon1'"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKendBloodMoon1"/>
      </effect_group>
    </buff>
  </append>
  <append xpath="/buffs/buff[@name='buffGSKDetectRespawn']">
    <effect_group help="end blood moon if player dies (respawns)">
      <requirement name="IsBloodMoon"/>
      <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKendBloodMoon1"/>
    </effect_group>
  </append>
</GhussakTweaks>
