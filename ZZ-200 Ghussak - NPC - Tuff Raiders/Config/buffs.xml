<?xml version="1.0"?>
<GhussakTweaks>
  <append xpath="/buffs">
    <buff name="buffGSKSpawnLandMine">
      <stack_type value="ignore"/>
      <duration value="0.07"/>
      <update_rate value="0.05"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffUpdate" action="CallGameEvent" event="eventGSKSpawnLandMine"/>
      </effect_group>
    </buff>
    <buff name="buffGSKnpcRaiderHealingKit" hidden="true">
      <stack_type value="replace"/>
      <duration value="0"/>
      <update_rate value="1"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="iGSKnpcRaiderMedkits" operation="add" value="-1"/>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="iGSKnpcRaiderHeal" operation="set" value="180"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKnpcRaiderHPmod" operation="set" value="1"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKnpcRaiderHPmod" operation="set" value="5">
          <requirement name="StatComparePercCurrentToModMax" stat="health" operation="LTE" value="0.90"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKnpcRaiderHPmod" operation="set" value="20">
          <requirement name="StatComparePercCurrentToModMax" stat="health" operation="LTE" value="0.75"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKnpcRaiderHPmod" operation="set" value="50" help="ISSUE? this may lead to a lucky final healing of extra 49, but it is no problem as is just a minor extra challenge.">
          <requirement name="StatComparePercCurrentToModMax" stat="health" operation="LTE" value="0.50"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="iGSKnpcRaiderHeal" operation="subtract" value="@iGSKnpcRaiderHPmod"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Health" operation="add" value="@iGSKnpcRaiderHPmod">
          <requirement name="StatComparePercCurrentToModMax" stat="health" operation="LT" value="1.0"/>
        </triggered_effect>
        <triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffGSKnpcRaiderHealingKit">
          <requirement name="CVarCompare" cvar="iGSKnpcRaiderHeal" operation="LTE" value="0"/>
        </triggered_effect>
      </effect_group>
    </buff>
    <buff name="buffGSKnpcRaiderSelfHealing" hidden="true">
      <stack_type value="replace"/>
      <duration value="0"/>
      <update_rate value="3"/>
      <effect_group>
        <triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="iGSKnpcRaiderMedkits" operation="set" value="randomInt(0,5)"/>
        <triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffGSKnpcRaiderHealingKit">
          <requirement name="!HasBuff" buff="buffGSKnpcRaiderHealingKit"/>
          <requirement name="StatComparePercCurrentToModMax" stat="health" operation="LTE" value="0.75"/>
          <requirement name="CVarCompare" cvar="iGSKnpcRaiderMedkits" operation="GT" value="0"/>
          <requirement name="CVarCompare" cvar="Ragdoll" operation="Equals" value="0"/>
        </triggered_effect>
      </effect_group>
    </buff>
  </append>
</GhussakTweaks>
